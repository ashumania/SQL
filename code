Select BI_SALES.REVENUE_TOP_LINE, BI_SALES.REVENUE_BOTTOM_LINE, BI_CAMPAIGN_DESCRIPTION.CHANNEL_DESCRIPTION, BI_SALES.SALES_TRANSACTION_DATE from BI_SALES 
left join BI_CAMPAIGN_DESCRIPTION on BI_SALES.SALES_TRANSACTION_CAMPAIGN_ID = BI_CAMPAIGN_DESCRIPTION.CAMPAIGN_ID
Where DATEDIFF(DAY, BI_SALES.SALES_TRANSACTION_DATE, GETDATE()) <= 90
Group by BI_SALES.REVENUE_TOP_LINE, BI_SALES.REVENUE_BOTTOM_LINE, BI_CAMPAIGN_DESCRIPTION.CHANNEL_DESCRIPTION, BI_SALES.SALES_TRANSACTION_DATE
Order By  BI_SALES.SALES_TRANSACTION_DATE
	
SELECT BI_VISIT.VISITOR_ID, COUNT(VISIT_ID) AS NUMBER_OF_VISIT, PAGE_VIEW_COUNT / SUM(PAGE_VIEW_COUNT) AS BOUNCE_RATE, BI_CAMPAIGN_DESCRIPTION.CHANNEL_DESCRIPTION FROM BI_VISIT 
Left Join BI_SALES on BI_VISIT.VISIT_ID=BI_SALES.VISIT 
Where DATEDIFF(DAY, BI_SALES.SALES_TRANSACTION_DATE, GETDATE()) <= 90 
GROUP BY BI_VISIT.VISITOR_ID, BI_CAMPAIGN_DESCRIPTION.CHANNEL_DESCRIPTION, BI_SALES.SALES_TRANSACTION_DATE
ORDER BY BI_SALES.SALES_TRANSACTION_DATE


SELECT COUNT(VISIT_ID) AS NUMBER_OF_VISIT, SUM(BI_SALES.REVENUE_TOP_LINE+BI_SALES.REVENUE_BOTTOM_LINE) AS revenue, BI_SALES.SALES_TRANSACTION_CAMPAIGN_ID, BI_CAMPAIGN_DESCRIPTION.CHANNEL_DESCRIPTION, COUNT(SALES_TRANSACTION_ID)/Count(VISITOR_ID) FROM BI_VISIT 
Left Join BI_SALES on BI_VISIT.VISIT_ID=BI_SALES.VISIT 
Where DATEDIFF(DAY, BI_SALES.SALES_TRANSACTION_DATE, GETDATE()) <= 90 
GROUP BY BI_CAMPAIGN_DESCRIPTION.CHANNEL_DESCRIPTION, BI_SALES.SALES_TRANSACTION_CAMPAIGN_ID, BI_SALES.SALES_TRANSACTION_DATE
ORDER BY BI_SALES.SALES_TRANSACTION_DATE
